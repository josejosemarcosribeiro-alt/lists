doctype html
html
  head
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1, shrink-to-fit=no')
    title Mcity Chennai
    link(href="/bower_components/bootstrap/dist/css/bootstrap.css", rel="stylesheet")
    link(href="/css/style.css", rel="stylesheet")

    //- Google Analytics
    script(async src="https://www.googletagmanager.com/gtag/js?id=G-MHWQFFW085")
    script.
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MHWQFFW085');
    //- End Google Analytics

  body
    div.container(style="max-width:425px")
      nav.navbar.navbar-dark.bg-dark.fixed-top
        a.navbar-brand.py-0(href='/') Lists / classifieds
        ul.navbar-nav.ml-auto
          if user
            li.nav-item
              a.btn.btn-outline-light(href='/list/add')
                ion-icon(name='md-add')
          else
            li.nav-item
              a.btn.btn-outline-light(href='/users/login')
                ion-icon(name='log-in')

      div.container.main-c
        br

        //- Flash messages seguras
        - var flashMessages = flash || {};
        if flashMessages.danger
          each msg in flashMessages.danger
            div(class="alert alert-danger") #{msg}
        if flashMessages.success
          each msg in flashMessages.success
            div(class="alert alert-success") #{msg}

        //- Erros de formulário
        if typeof errors !== 'undefined' && errors
          each err in errors
            div(class="alert alert-danger") #{err.msg}

        //- Mensagens genéricas (compatível com helpers)
        if typeof messages !== 'undefined'
          != messages('message', locals)

        block content

      footer.navbar.navbar-nav.fixed-bottom
        hr
        div.container
          div.btn-group.btn-group-lg.text-center(role="group")
            a.btn.btn-dark(href='#', onClick="history.back();")
              ion-icon(name='arrow-back')

            //- Botões de edição e exclusão seguros
            if user && typeof item !== 'undefined' && item
              if user._id && item.author && user._id.toString() === item.author.toString()
                a.btn.btn-danger.delete-item(href='#', data-id=item._id)
                  ion-icon(name='trash')
                a.btn.btn-dark(href='/list/item/edit/'+item._id)
                  ion-icon(name='create')

    //- Scripts
    script(src="/bower_components/jquery/dist/jquery.js")
    script(src="/bower_components/bootstrap/dist/js/bootstrap.js")
    script(src='https://unpkg.com/ionicons@4.5.5/dist/ionicons.js')
    script(src="/js/main.js")
